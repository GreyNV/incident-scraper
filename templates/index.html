<!DOCTYPE html>
<html>
<head>
    <title>Incident Collector</title>
</head>
<body>
    <h1>Rockland FireWatch Incidents</h1>
    <form action="{{ url_for('fetch_route') }}" method="post">
        <button type="submit">Fetch Incidents Now</button>
    </form>

    {% if csv_exists %}
    <form action="{{ url_for('download_csv') }}" method="get" style="margin-top:10px;">
        <button type="submit">Export CSV</button>
    </form>

    {% if incidents %}
    <table border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>Time Reported</th>
                <th>Address</th>
                <th>Incident Type</th>
                <th>Name</th>
                <th>Phone</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody>
            {% for row in incidents %}
            <tr>
                <td>{{ row.time_reported }}</td>
                <td>{{ row.address }}</td>
                <td>{{ row.incident_type }}</td>
                <td>{{ row.name }}</td>
                <td>{{ row.phone }}</td>
                <td>{{ row.email }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    {% else %}
    <p>No data available yet.</p>
    {% endif %}
</body>
</html>
